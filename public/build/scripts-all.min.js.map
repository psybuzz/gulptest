{"version":3,"sources":["App.js","Audio.js","CanvasView.js","Controls.js","Gamepad.js","Keyboard.js","MiscUtils.js","network.js","SceneInterface.js","SceneManager.js","ChairModel.js","ToonShader.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC9EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC3HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"scripts-all.min.js","sourcesContent":["/**\n * This file contains logic related to the main application.\n */\n\nfunction Application(options){\n\t_.extend(this, options || {});\n    this.start();\n}\n\nApplication.prototype = {\n    /**\n     * Setup and start the application.\n     */\n    start: function (){\n        // this.setupStats();\n        this.canvasView.initialize();\n        this.sceneManager.initialize({\n            canvasView: this.canvasView,\n            // stats: this.stats\n        });\n    },\n\n    /**\n     * Setup Dat.GUI and stats.\n     */\n    setupStats: function (){\n        this.gui = new dat.GUI();\n        this.stats = new Stats();\n        $('body').append(this.stats.domElement);\n    },\n\n    get scene(){\n        return this.sceneManager.currScene;\n    }\n};\n","/**\n * This file contains audio related logic to control sounds.\n */\n\n/**\n * Audio module.\n */\nvar Audio = {\n\taudioTags: [\n\t\tdocument.getElementById('sound1'),\n\t\tdocument.getElementById('sound2'),\n\t\tdocument.getElementById('sound3'),\n\t],\n\n\tdynamicTag: document.getElementById('dynamicSound'),\n\n\t/**\n\t * Play a sound using a predefined audio tag.\n\t * \n\t * @param  {Number} index  \tThe audio tag index.\n\t * @param  {Number} volume \tThe volume from 0 to 1.\n\t */\n\tplay: function (track, volume){\n\t\tif (typeof track === 'undefined'){\n\t\t\tconsole.error('Bad track: Tried to play a missing sound');\n\t\t}\n\n\t\tvar tag = this.audioTags[track];\n\t\tif (volume) tag.volume = volume;\n\t\ttag.play();\n\t},\n\n\tplaySrc: function (src, volume){\n\t\tthis.dynamicTag.src = src;\n\t\tif (volume) this.dynamicTag.volume = volume;\n\t\tthis.dynamicTag.oncanplay = function (){\n\t\t\tthis.play();\n\t\t};\n\t}\n};\n","/**\n * This file contains logic related to the canvas.\n */\n\nvar CanvasView = {\n\tw: null, h: null,\n\tcamera: null,\n\trenderer: null,\n\t$el: $('#canvasContainer'),\n\n\tinitialize: function (options){\n\t\toptions = options || {};\n\t\tthis.w = window.innerWidth;\n\t\tthis.h = window.innerHeight;\n\n\t\t// Setup THREE renderer.\n\t\tthis.setupRenderer();\n\n\t\t// On window resize.\n\t\tvar onWindowResizeBound = this.onWindowResize.bind(this);\n\t\twindow.addEventListener('resize', onWindowResizeBound, false);\n\t},\n\n\trender: function (scene, camera){\n\t\tthis.renderer.render(scene, camera);\n\t},\n\n\tsetupRenderer: function (){\n\t\tthis.renderer = new THREE.WebGLRenderer({antialias: true, alpha: true});\n\t\t// this.renderer.setClearColor(0xffffff);\n\n\t\t// Add canvas to page.\n\t\tthis.$el.append(this.renderer.domElement);\n\t},\n\n\tonWindowResize: function(){\n\t\tvar w = this.w = window.innerWidth, h = this.h = window.innerHeight;\n\t\tthis.renderer.setSize(w, h);\n\t\tthis.$el.css({\n\t\t\t'width': w+'px',\n\t\t\t'height': h+'px'\n\t\t});\n\n\n\t\tif (this.camera){\n\t\t\tconsole.log('updating camera');\n\t\t\tthis.camera.aspect = w/h;\n\t\t\tthis.camera.updateProjectionMatrix();\n\t\t}\n\t}\n};\n","function StandardControls() {\r\n    \r\n}\r\n\r\nStandardControls.prototype = {\r\n    // event, callback, sensitivity\r\n    // .on('forward', () => { position += 1 }, 0.8);\r\n    on: function(event, cb, sensitivity){\r\n        if (typeof this[event] !== \"function\")\r\n            return;\r\n        var status = this[event]();\r\n        if (status && (!sensitivity || status >= sensitivity))\r\n            cb(status);\r\n    },\r\n\r\n    forward: function(){\r\n        var g = Gamepad.get(0);\r\n        if (g)\r\n            return -g.axes[1];\r\n        return Key.isPressed(\"S\") ? -1 : (Key.isPressed(\"W\") ? 1 : 0);\r\n    },\r\n\r\n    strafe: function(){\r\n        var g = Gamepad.get(0);\r\n        if (g)\r\n            return g.axes[0];\r\n        return Key.isPressed(\"A\") ? -1 : (Key.isPressed(\"D\") ? 1 : 0);\r\n    },\r\n\r\n    turn: function(){\r\n        var g = Gamepad.get(0);\r\n        if (g)\r\n            return g.axes[2];\r\n        return Key.isPressed(\"LEFT\") ? -1 : (Key.isPressed(\"RIGHT\") ? 1 : 0);\r\n    },\r\n\r\n    raise: function(){\r\n        var g = Gamepad.get(0);\r\n        if (g)\r\n            return -g.axes[3];\r\n        return Key.isPressed(\"DOWN\") ? -0.5 : (Key.isPressed(\"UP\") ? 0.5 : 0);\r\n    },\r\n\r\n    circle: function(){\r\n        var g = Gamepad.get(0);\r\n        if (g)\r\n            return g.buttons[1].pressed;\r\n        return Key.isPressed(\"SPACE\");\r\n    },\r\n\r\n    cross: function(){\r\n        var g = Gamepad.get(0);\r\n        if (g)\r\n            return g.buttons[0].pressed;\r\n        return Key.isPressed(\"SHIFT\");\r\n    },\r\n\r\n    triangle: function(){\r\n        var g = Gamepad.get(0);\r\n        if (g)\r\n            return g.buttons[3].pressed;\r\n        return Key.isPressed(\"SHIFT\");\r\n    },\r\n\r\n    square: function(){\r\n        var g = Gamepad.get(0);\r\n        if (g)\r\n            return g.buttons[2].pressed;\r\n        return Key.isPressed(\"SHIFT\");\r\n    },\r\n\r\n    defaultActions: function(){\r\n        var g = Gamepad.get(0);\r\n        if (g && g.buttons[16].pressed)\r\n            window.location.reload();\r\n    }\r\n}\r\n\r\n","var Gamepad = {\r\n    get: function (i) {\r\n        var gamepads = navigator.getGamepads();\r\n        return gamepads[i];\r\n    }\r\n};\r\n\r\nwindow.addEventListener(\"gamepadconnected\", function(e) {\r\n    console.log(\"Gamepad connected at index %d: %s. %d buttons, %d axes.\",\r\n    e.gamepad.index, e.gamepad.id,\r\n    e.gamepad.buttons, e.gamepad.axes);\r\n});\r\n\r\n\r\n\r\n","/**\r\n * This file contains logic for input control.  For example, a Keyboard module\r\n * controls behavior related to keypresses.\r\n *\r\n * A super-basic lightweight subscription model allows other objects to listen \r\n * for keypress events.\r\n *\r\n * Sources\r\n * Keyboard Input helper\r\n * - http://nokarma.org/2011/02/27/javascript-game-development-keyboard-input/\r\n * \r\n * Usage: Key.isPressed(\"UP\")\r\n */\r\n\r\n/**\r\n * Keyboard module.\r\n */\r\nvar Key = {\r\n\tpressed: {},\r\n\r\n\tkeycodeMap: {\r\n\t\t\"LEFT\": 37,\r\n\t\t\"UP\": 38,\r\n\t\t\"RIGHT\": 39,\r\n\t\t\"DOWN\": 40,\r\n\t\t\"W\": 87,\r\n\t\t\"A\": 65,\r\n\t\t\"S\": 83,\r\n\t\t\"D\": 68,\r\n\t\t\"Q\": 81,\r\n\t\t\"E\": 69,\r\n\t\t\"ENTER\": 13,\r\n\t\t\"SPACE\": 32,\r\n\t\t\"SHIFT\": 16,\r\n\t\t\"CTRL\": 17,\r\n\t\t\"ESC\": 27\r\n\t},\r\n\r\n\teventCallbacks: {\r\n\t\tkeydown: [],\r\n\t\tkeyup: []\r\n\t},\r\n\r\n\tisDown: function(keyCode){\r\n\t\treturn this.pressed[keyCode];\r\n\t},\r\n\r\n\tanyDown: function(){\r\n\t\tvar p = this.pressed;\r\n\t\tvar map = this.keycodeMap;\r\n\t\tvar keys = Object.keys(map);\r\n\t\tfor (var i=0; i<keys.length; i++){\r\n\t\t\tif (p[map[keys[i]]] === true){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t},\r\n\r\n\tonKeyDown: function(e){\r\n\t\tthis.pressed[e.keyCode] = true;\r\n\t},\r\n\r\n\tonKeyUp: function(e){\r\n\t\tthis.pressed[e.keyCode] = undefined;\r\n\t},\r\n\r\n\tmatches: function (keyCode, keys){\r\n\t\tfor (var i=0; i<keys.length; i++){\r\n\t\t\tvar key = keys[i];\r\n\r\n\t\t\t// Check if the key matches.\r\n\t\t\tif (keyCode === this.keycodeMap[key]){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Return false if there is no match.\r\n\t\treturn false;\r\n\t},\r\n\r\n\tisPressed: function (keys){\r\n\t\tif (!Array.isArray(keys)) {\r\n\t\t\tkeys = [keys];\r\n\t\t}\r\n\r\n\t\tfor (var i=0; i<keys.length; i++){\r\n\t\t\tvar key = keys[i];\r\n\r\n\t\t\t// Check if the key is valid.\r\n\t\t\tif (!this.keycodeMap[key]){\r\n\t\t\t\tconsole.error('Key not found');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Return true if the key is pressed.\r\n\t\t\tif (this.pressed[this.keycodeMap[key]] === true){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Return false by default if none of the keys were pressed.\r\n\t\treturn false;\r\n\t},\r\n\r\n\tlistenTo: function (evt, callback){\r\n\t\tvar evtArray = this.eventCallbacks[evt];\r\n\t\tif (!evtArray) console.error('Tried to subscribe to an unknown keyboard event.');\r\n\t\t\r\n\t\tevtArray.push(callback);\r\n\t},\r\n\r\n\tstopListeningTo: function () {\r\n\t\t// TODO: Use a backbone-like method of listening.\r\n\t}\r\n};\r\n\r\n\r\n// Bind keypress events.\r\ndocument.body.onkeydown = function (e){\r\n\tKey.onKeyDown(e);\r\n\tKey.eventCallbacks.keydown.map(function (cb){\r\n\t\tcb(e);\r\n\t});\r\n};\r\n\r\ndocument.body.onkeyup = function(e){\r\n\tKey.onKeyUp(e);\r\n\tKey.eventCallbacks.keyup.map(function (cb){\r\n\t\tcb(e);\r\n\t});\r\n};\r\n","/**\n * This file defines several general-use, miscellaneous utility functions which\n * can be used in other script files.\n */\n\nvar Utils = {\n    clamp: function(val, max, min){\n        return Math.min(Math.max(min, val), max);\n    },\n\n    randFrom: function(lo, hi){\n        return Math.random()*(hi-lo) + lo;\n    },\n\n\tnow: function (){\n\t\treturn (performance && performance.now) ? performance.now() : Date.now();\n\t},\n\n\trandomRGB: function (){\n\t\treturn {\n\t\t\tr: Math.floor(Math.random()*255),\n\t\t\tg: Math.floor(Math.random()*255),\n\t\t\tb: Math.floor(Math.random()*255)\n\t\t};\n\t},\n\n\trandomColor: function (){\n\t\tvar r = Math.floor(Math.random()*255);\n\t\tvar g = Math.floor(Math.random()*255);\n\t\tvar b = Math.floor(Math.random()*255);\n\n\t\treturn 'rgb('+r+','+g+','+b+')';\n\t},\n\n\trandomHex: function (){\n\t\tvar color = this.randomRGB();\n\n\t\treturn this.rgbToHex(color.r, color.g, color.b);\n\t},\n\n\t/**\n\t * Converts RGB integers into Hex format.\n\t */\n\trgbToHex: function (r, g, b){\n\t\tvar red = r.toString(16);\n\t\tvar green = g.toString(16);\n\t\tvar blue = b.toString(16);\n\t\tred = red == \"0\" ? \"00\" : red;\n\t\tgreen = green == \"0\" ? \"00\" : green;\n\t\tblue = blue == \"0\" ? \"00\" : blue;\n\n\t\treturn parseInt(red+green+blue, 16);\n\t},\n\n\trandomName: function (){\n\t\treturn Names.random();\n\t},\n\n\t/**\n\t * Returns the object and index from the input array that is the closest to \n\t * the target value.  This will attempt binary search if the input array is\n\t * sorted.\n\t * \n\t * @param  {Array.Number} arr    \tThe input array.\n\t * @param  {Number} target \t\t\tThe target value to match.\n\t * @param  {boolean} isSorted \t\tWhether the input array is sorted.\n\t * \n\t * @return {Object}        \t\t\tA result object containing the closest \n\t *                              \tmatch and its index.\n\t */\n\tgetClosestMatch: function (arr, target, isSorted){\n\t\tisSorted = !!isSorted;\n\t\tvar bestDiff = Infinity;\n\t\tvar bestMatch = null;\n\t\tvar candidate, diff, absDiff;\n\n\t\tif (arr.length === 0){\n\t\t\treturn console.error('Tried to find a closest match using an empty input array.');\n\t\t} else if (arr.length === 1){\n\t\t\treturn arr[0];\n\t\t}\n\n\t\t// Check whether or not we can try binary search.\n\t\tif (isSorted){\n\t\t\tvar start = 0, end = arr.length-1;\n\t\t\twhile (start <= end){\n\t\t\t\tvar center = Math.floor((start+end)/2);\n\t\t\t\tcandidate = arr[center];\n\t\t\t\tdiff = candidate - target;\n\t\t\t\tabsDiff = Math.abs(diff);\n\n\t\t\t\t// Try to update the best match.\n\t\t\t\tif (absDiff < bestDiff){\n\t\t\t\t\tbestDiff = absDiff;\n\t\t\t\t\tbestMatch = candidate;\n\t\t\t\t}\n\n\t\t\t\t// Update start/end bounds.\n\t\t\t\tif (diff > 0){\n\t\t\t\t\tend = center-1;\n\t\t\t\t} else if (diff < 0){\n\t\t\t\t\tstart = center+1;\n\t\t\t\t} else {\n\t\t\t\t\t// We've found an exact match.\n\t\t\t\t\tbestDiff = diff;\n\t\t\t\t\tbestMatch = candidate;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tfor (var i=0; i<arr.length; i++){\n\t\t\t\tcandidate = arr[i];\n\t\t\t\tdiff = candidate - target;\n\t\t\t\tabsDiff = Math.abs(diff);\n\t\t\t\tif (absDiff < bestDiff){\n\t\t\t\t\tbestDiff = absDiff;\n\t\t\t\t\tbestMatch = candidate;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn bestMatch;\n\t}\n};\n","function get (url){\r\n    return new Promise(function (resolve, reject){\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.open(\"GET\", url, true);\r\n        xhr.onreadystatechange = function (e){\r\n            if (xhr.readyState !== 4)\r\n                return;\r\n            if ([0, 200, 304].indexOf(xhr.status) === -1)\r\n                reject();\r\n            else\r\n                resolve(e.target.response);\r\n        };\r\n        xhr.send(null);\r\n    });\r\n}\r\n","/**\n * This file contains a Scene interface.\n */\n\nfunction Scene(){\n\t/**\n\t * The THREE scene to be rendered.\n\t * @type {THREE.Scene}\n\t */\n\tthis.THREEScene = null;\n\n\t/**\n\t * The THREE camera to use.\n\t * @type {THREE.Camera}\n\t */\n\tthis.camera = null;\n}\n\n/**\n * The callback to be run when the scene is loaded.\n */\nScene.prototype.open = function(){};\n\n/**\n * The update function to be called each animation cycle.\n */\nScene.prototype.update = function(){};\n\n/**\n * The callback to be run when the scene is closed.\n * Optional\n */\nScene.prototype.onClose = function(){};\n\n","/**\n * This file contains a module for managing scenes.\n */\n\nvar SceneManager = {\n\tcurrScene: null,\n\tisPlaying: false,\n\tlastTime: Date.now(),\n\n\tinitialize: function (options){\n\t\toptions = options || {};\n\t\tthis.canvasView = options.canvasView;\n\t\tthis.stats = options.stats;\n\n\t\t// Define a set of scenes.\n\t\tthis.scenes = {};\n\n\t\t// Bind functions.\n\t\tthis.animateBound = this.animate.bind(this);\n\t},\n\n    registerScene: function (name, scene){\n        if (name && scene)\n            this.scenes[name] = scene;\n    },\n\n\tplay: function (){\n\t\tif (this.isPlaying) return;\n\n\t\tthis.isPlaying = true;\n\t\tthis.animateBound();\n\t},\n\n\tpause: function (){\n\t\tif (!this.isPlaying) return;\t\n\n\t\tthis.isPlaying = false;\n\t},\n\n\tanimate: function (){\n\t\tif (this.stats) this.stats.begin();\n        var time = Date.now();\n\t\tvar delta = time - this.lastTime;\n\t\tthis.lastTime = time;\n\n\t\t// Update the current scene.\n\t\tif (this.currScene){\n\t\t\tthis.currScene.update(time, delta);\n\t\t}\n\t\tTWEEN.update(time);\n\n\t\t// Render.\n\t\tthis.canvasView.render(this.currScene.THREEScene, this.currScene.camera);\n\n\t\tif (this.stats) this.stats.end();\n\t\tif (this.isPlaying) {\n            if (this.isSlow)\n\t\t        setTimeout(this.animateBound, this.isSlow || 50);\n            else\n                requestAnimationFrame(this.animateBound);\n        }\n\t},\n\n\tloadScene: function (sceneName){\n\t\tvar scene = this.scenes[sceneName];\n\t\t\n\t\t// Check that the requested scene is valid and different.\n\t\tif (!scene) return console.error('Tried to load an unknown scene.');\n\t\tif (scene === this.currScene) return;\n\n\t\t// Notify the current scene to transition out.\n\t\tif (this.currScene && this.currScene.onClose){\n\t\t\tthis.currScene.onClose();\n\t\t}\n\n\t\t// Set and open the current scene.\n\t\tthis.currScene = scene;\n\t\tthis.canvasView.camera = scene.camera;\n\t\tthis.canvasView.onWindowResize();\n\t\tscene.open();\n\n\t\treturn this;\n\t}\n};\n","/**\r\n * This file defines a chair model.\r\n */\r\n\r\nfunction ChairModel (options){\r\n    var defaults = {\r\n        width: 4,\r\n        depth: 4,\r\n        height: 8,\r\n        legRadius: 0.12,\r\n        feetHeightRatio: 0.1,\r\n        archRadius: 0.5\r\n    };\r\n    Object.assign(this, defaults || {}, options || {});\r\n\r\n\tvar feet_mat = new THREE.MeshBasicMaterial({color: 'gray'});\r\n\tvar backrest_mat = new THREE.MeshLambertMaterial({color: 'white'});\r\n\tvar seatrest_mat = new THREE.MeshLambertMaterial({color: 'white'});\r\n    var leg_mat = new THREE.MeshBasicMaterial({color: 'white'});\r\n\tvar result = new THREE.Group();\r\n\r\n    var h = this.height;\r\n    var w = this.width;\r\n    var d = this.depth;\r\n    var legr = this.legRadius;\r\n    var halfw = this.width / 2;\r\n    var halfd = this.depth / 2;\r\n    var halfh = this.height / 2;\r\n    var feeth = (halfh) * this.feetHeightRatio;\r\n    var ar = this.archRadius;\r\n\r\n    // Make back leg arch (legs, back).\r\n    // Make front leg arch (legs, seat, back - offset).\r\n    var BackArchCurve = THREE.Curve.create(\r\n        function (){},\r\n        function (t){\r\n            var firstT = h / (h * 2 + w);\r\n            var secondT = 1 - firstT;\r\n            var firstH = h / firstT;\r\n            var tx, ty, tz;\r\n            if (t < firstT) {\r\n                tx = -halfw;\r\n                ty = t * firstH;\r\n                tz = 0;\r\n            } else if (t < secondT) {\r\n                tx = -halfw + t* 5,\r\n                ty = h,\r\n                tz = 0;\r\n            } else {\r\n                tx = halfw,\r\n                ty = h - (t-secondT) * firstH,\r\n                tz = 0;\r\n            }\r\n            return new THREE.Vector3(tx, ty, tz);\r\n        }\r\n    );\r\n    var back_arch_geo = new THREE.TubeGeometry(\r\n        new BackArchCurve(),  //path\r\n        20,    //segments\r\n        legr,   //radius\r\n        8,     //radiusSegments\r\n        false  //closed\r\n    );\r\n    var backArchMesh = new THREE.Mesh(back_arch_geo, leg_mat);\r\n    backArchMesh.position.z = -halfd;\r\n\r\n    var FrontArchCurve = THREE.Curve.create(\r\n        function (){},\r\n        function (t){\r\n            var firstT = h / (h * 2 + w);\r\n            var secondT = 1 - firstT;\r\n            var firstH = halfh / firstT;\r\n            var tx, ty, tz;\r\n            if (t < firstT) {\r\n                tx = -halfw;\r\n                ty = t * firstH;\r\n                tz = 0;\r\n            } else if (t < secondT) {\r\n                tx = -halfw + t* 5,\r\n                ty = halfh,\r\n                tz = 0;\r\n            } else {\r\n                tx = halfw,\r\n                ty = halfh - (t-secondT) * firstH,\r\n                tz = 0;\r\n            }\r\n            return new THREE.Vector3(tx, ty, tz);\r\n        }\r\n    );\r\n    var front_arch_geo = new THREE.TubeGeometry(\r\n        new FrontArchCurve(),  //path\r\n        20,    //segments\r\n        legr,   //radius\r\n        8,     //radiusSegments\r\n        false  //closed\r\n    );\r\n    var frontArchMesh = new THREE.Mesh(front_arch_geo, leg_mat);\r\n    frontArchMesh.position.z = halfd;\r\n    result.add(backArchMesh, frontArchMesh);\r\n\r\n    // Make backrest, seatrest.\r\n    var backrest_geo = new THREE.BoxGeometry(w, h/4, legr*2);\r\n    var seatrest_geo = new THREE.BoxGeometry(w, legr*2, d);\r\n    var backrestMesh = new THREE.Mesh(backrest_geo, backrest_mat);\r\n    var seatrestMesh = new THREE.Mesh(seatrest_geo, seatrest_mat);\r\n    backrestMesh.position.set(0, h*(0.5+0.25+0.125), -halfd);\r\n    seatrestMesh.position.set(0, h/2, 0);\r\n    result.add(backrestMesh, seatrestMesh);\r\n\r\n    // Add feet.\r\n    var feet_geo = new THREE.CylinderGeometry(legr+0.01, legr+0.01, feeth);\r\n\tvar f1 = new THREE.Mesh(feet_geo, feet_mat);\r\n\tvar f2 = new THREE.Mesh(feet_geo, feet_mat);\r\n\tvar f3 = new THREE.Mesh(feet_geo, feet_mat);\r\n\tvar f4 = new THREE.Mesh(feet_geo, feet_mat);\r\n\tf1.position.set(halfw, 0, halfd);\r\n\tf2.position.set(halfw, 0, -halfd);\r\n    f3.position.set(-halfw, 0, halfd);\r\n\tf4.position.set(-halfw, 0, -halfd);\r\n\tresult.add(f1, f2, f3, f4);\r\n\r\n\treturn result;\r\n}\r\n","/**\n * This file uses code from NeoComputer's website to create a toon-like effect \n * using a fragment shader.\n * http://www.neocomputer.org/projects/donut/\n */\n\nvar toon = false;\nif (toon){\n\tTHREE.ShaderLib.lambert.fragmentShader = THREE.ShaderLib.lambert.fragmentShader.replace(/^\\s\\s*/, '').replace(/\\s\\s*$/, '');\n\tTHREE.ShaderLib.lambert.fragmentShader = \"uniform vec3 diffuse;\\n\" + THREE.ShaderLib.lambert.fragmentShader.substr(0, THREE.ShaderLib.lambert.fragmentShader.length-1);\n\tTHREE.ShaderLib.lambert.fragmentShader += [\n\t\t\"#ifdef USE_MAP\",\n\t\t\"\tgl_FragColor = texture2D( map, vUv );\",\n\t\t\"#else\",\n\t\t\"\tgl_FragColor = vec4(diffuse, 1.0);\",\n\t\t\"#endif\",\n\t\t\"\tvec3 basecolor = vec3(gl_FragColor[0], gl_FragColor[1], gl_FragColor[2]);\",\n\t\t\"\tfloat alpha = gl_FragColor[3];\",\n\t\t\"\tfloat vlf = vLightFront[0];\",\n\t\t// Clean and simple //\n\t\t\"\tif (vlf< 0.50) { gl_FragColor = vec4(mix( basecolor, vec3(0.0), 0.5), alpha); }\",\n\t\t\"\tif (vlf>=0.50) { gl_FragColor = vec4(mix( basecolor, vec3(0.0), 0.3), alpha); }\",\n\t\t\"\tif (vlf>=0.75) { gl_FragColor = vec4(mix( basecolor, vec3(1.0), 0.0), alpha); }\",\n\t\t//\"\tif (vlf>=0.95) { gl_FragColor = vec4(mix( basecolor, vec3(1.0), 0.3), alpha); }\",\n\t\t//\"\tgl_FragColor.xyz *= vLightFront;\",\n\t\t\"}\"\n\t\t].join(\"\\n\");\n}\n"],"sourceRoot":"/source/"}